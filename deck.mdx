import { swiss } from '@mdx-deck/themes';
import CodeSandboxLayout from './layouts/CodeSandboxLayout';
import MainLayout from './layouts/MainLayout';
import './layouts/slides.css';

import CodeBlock from './components/CodeBlock';
import Column from './components/Column';
import MachineInspector from './components/MachineInspector';
import Row from './components/Row';
import TrafficLight from './components/TrafficLight';
import TrafficLightWithControl from './components/TrafficLightWithControl';
import VideoBlock from './components/VideoBlock';

import { calibrationSwitch } from './code/calibration-bugs';
import { simpleStateMachine } from './code/simple-state-machine';
import {
  expandedTrafficLightMachineCode,
  trafficLightCode,
  trafficLightMachineCode,
} from './code/traffic-light';

export const theme = swiss;

<Head>
  <title>Modeling UI with Statecharts</title>
</Head>

<MainLayout>


# Modeling UI with Statecharts

Kelli Rockwell

</MainLayout>


---

<MainLayout>


# We as developers and designers are really good at making the impossible, possible.

</MainLayout>


---

<MainLayout>


# Sometimes, we're so good at it, we do it unintentionally!

</MainLayout>


---

<MainLayout horizontalAlignment='center'>


import sutro from './images/sutro.png';

<img src={sutro} />

</MainLayout>


---

<MainLayout horizontalAlignment='center'>


import loadingSpinner from './videos/loading-spinner.mp4';

<VideoBlock label={'*Dramatization, not actual user recording'} source={loadingSpinner} />

</MainLayout>


---

<MainLayout horizontalAlignment='center'>


# ...

</MainLayout>


---

<MainLayout horizontalAlignment='center'>


import inProgress from './videos/in-progress.mp4';

<VideoBlock label={'*Dramatization, not actual user recording'} source={inProgress} />

</MainLayout>


---

<MainLayout>


# These are both "impossible states." So how did the user end up here?

</MainLayout>


---

<MainLayout verticalAlignment='top'>


# How did the user end up here?

- We changed the application logic and the UI got out of sync

</MainLayout>


---

<MainLayout verticalAlignment='top'>


# How did the user end up here?

- We changed the application logic and the UI got out of sync
- We tried to take a shortcut

</MainLayout>


---

<MainLayout>


Default case is supposedly impossible to reach:

<CodeBlock>{calibrationSwitch}</CodeBlock>

</MainLayout>


---

<MainLayout verticalAlignment='top'>


# How did the user end up here?

- We changed the application logic and the UI got out of sync
- We tried to take a shortcut
- We forgot to reset a condition
- We missed an edge case
- We didn't handle an API response properly
- ...

</MainLayout>


---

<MainLayout>


# We need a better model for our state.

</MainLayout>


---

<MainLayout horizontalAlignment='center'>


import hwFlowDiagram from './videos/hw-flow-diagram.mp4';

<VideoBlock source={hwFlowDiagram} />

</MainLayout>


---

import statechart1 from './images/reassuring-statechart.jpeg';
import statechart2 from './images/reassuring-statechart-2.jpeg';
import statechart3 from './images/reassuring-statechart-3.jpeg';

<MainLayout>


# Finite State Machines!

<Row height="30vh">
  <img src={statechart1} style={{ flex: 1, width: '100%' }} />
  <img src={statechart2} style={{ flex: 1, width: '25vw', height: 'auto' }} />
  <img src={statechart3} style={{ flex: 1, width: '25vw', height: 'auto' }} />
</Row>

</MainLayout>


---

<MainLayout>


# We're already used to thinking in state machines.

</MainLayout>


---

<MainLayout horizontalAlignment='center'>


<TrafficLightWithControl />

</MainLayout>


---

<MainLayout>


# First rule of Finite State Machines:

### You can only be in one state at any given time.

</MainLayout>


---

<MainLayout horizontalAlignment='center'>


<TrafficLightWithControl auto={true} />

</MainLayout>


---

<MainLayout>


# Second rule of Finite State Machines:

### You have a finite number of discrete states.

</MainLayout>


---

<MainLayout horizontalAlignment="center">
  <Row width="70vw">
    <TrafficLight currentColor="green" />
    <TrafficLight currentColor="yellow" />
    <TrafficLight currentColor="red" />
    <TrafficLight currentColor="hazard" />
  </Row>
</MainLayout>

---

<MainLayout>


# Third rule of Finite State Machines:

### You transition from one state to another based on an event.

</MainLayout>


---

<MainLayout horizontalAlignment='center'>


<TrafficLightWithControl />

</MainLayout>


---

<MainLayout>


# As a driver,

# Given, the light is red,

# When, 30 seconds have elapsed,

# Then, the light turns green.

</MainLayout>


---

<MainLayout>


import prototypes from './images/prototypes.png';

<img src={prototypes} />

</MainLayout>


---

<MainLayout>


<CodeBlock fontSize="medium">{simpleStateMachine}</CodeBlock>

</MainLayout>


---

<MainLayout>


The problem here isn't the switch statement, it's that **the state machine is implicit**

<CodeBlock>{calibrationSwitch}</CodeBlock>

</MainLayout>


---

<MainLayout horizontalAlignment='center'>


import xstate from './images/xstate.png';

<img src={xstate} />

</MainLayout>


---

<MainLayout>


<MachineInspector id="trafficLight" />

<CodeBlock>{trafficLightMachineCode}</CodeBlock>

</MainLayout>


---

<MainLayout>


<MachineInspector id="expandedTrafficLight" />

<CodeBlock>{expandedTrafficLightMachineCode}</CodeBlock>

</MainLayout>


---

<MainLayout>


# Statechart = finite state machine with nested and/or parallel states

</MainLayout>


---

<MainLayout horizontalAlignment='center'>


import stateExplosion from './images/state-explosion.svg';

<img src={stateExplosion} />

</MainLayout>


---

<MainLayout horizontalAlignment='center'>


import stateExplosionFixed from './images/state-explosion-fixed.svg';

<img src={stateExplosionFixed} />

</MainLayout>


---

<MainLayout>


<CodeBlock>{expandedTrafficLightMachineCode}</CodeBlock>

</MainLayout>


---

<MainLayout>


<CodeBlock fontSize="small">{trafficLightCode}</CodeBlock>

</MainLayout>


---

<MainLayout>


# Enough with the traffic lights already!

</MainLayout>


---

<CodeSandboxLayout id={0} />

---

<CodeSandboxLayout id={1} />

---

<CodeSandboxLayout id={2} />

---

<CodeSandboxLayout id={3} />

---

<MainLayout verticalAlignment="top">


# Takeaways

<Notes>- On that note, let's talk takeaways</Notes>

</MainLayout>


---

<MainLayout verticalAlignment="top">


# Takeaways

- Keeping UI in sync with application logic is universally hard

</MainLayout>


---

<MainLayout verticalAlignment="top">


# Takeaways

- Keeping UI in sync with application logic is universally hard
- Implicit state machines make it harder

</MainLayout>


---

<MainLayout verticalAlignment="top">


# Takeaways

- Keeping UI in sync with application logic is universally hard
- Implicit state machines make it harder
- You're probably already thinking in state machines

</MainLayout>


---

<MainLayout verticalAlignment="top">


# Takeaways

- Keeping UI in sync with application logic is universally hard
- Implicit state machines make it harder
- You're probably already thinking in state machines
- Statecharts = beefed up state machines

</MainLayout>


---

<MainLayout verticalAlignment="top">


# Takeaways

- Keeping UI in sync with application logic is universally hard
- Implicit state machines make it harder
- You're probably already thinking in state machines
- Statecharts = beefed up state machines
- **Modeling UI with statecharts is something you should consider doing :)**

</MainLayout>


---

<MainLayout horizontalAlignment="center">


# Thank you!

</MainLayout>

